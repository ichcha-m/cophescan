<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CoPheScan: Example with Hierarchical Priors • cophescan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CoPheScan: Example with Hierarchical Priors">
<meta property="og:description" content="cophescan">
<meta property="og:image" content="https://ichcha-m.github.io/cophescan/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cophescan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IntroductionCoPheScan_01.html">Introduction to CoPheScan</a>
    </li>
    <li>
      <a href="../articles/InputData_02.html">CoPheScan: Input data</a>
    </li>
    <li>
      <a href="../articles/FixedPriors_03.html">CoPheScan: Example with Fixed Priors</a>
    </li>
    <li>
      <a href="../articles/HierarchicalPriors_04.html">CoPheScan: Example with Hierarchical Priors</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ichcha-m/cophescan/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>CoPheScan: Example with Hierarchical Priors</h1>
                        <h4 data-toc-skip class="author">Ichcha
Manipur</h4>
            
            <h4 data-toc-skip class="date">2023-08-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ichcha-m/cophescan/blob/HEAD/vignettes/HierarchicalPriors_04.Rmd" class="external-link"><code>vignettes/HierarchicalPriors_04.Rmd</code></a></small>
      <div class="hidden name"><code>HierarchicalPriors_04.Rmd</code></div>

    </div>

    
    
<p>The hierarchical model is ideal when a large set of variants and
phenotypes are available i.e., a phenome-wide association study with a
set of variants which are previously known to have a functional role or
have been implicated in a disease. Here we show how to use cophescan to
infer hierarchical priors on a small test dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ichcha-m/cophescan" class="external-link">cophescan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"cophe_multi_trait_data"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">cophe_multi_trait_data</span><span class="op">)</span></span>
<span><span class="va">trait_dat</span> <span class="op">=</span> <span class="va">cophe_multi_trait_data</span><span class="op">$</span><span class="va">summ_stat</span><span class="op">$</span><span class="va">Trait_1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trait_dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 8</span></span>
<span><span class="co">#&gt;  $ beta   : Named num [1:1000] -0.01369 0.01666 0.09057 -0.00571 -0.05606 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:1000] "chr19-11173352" "chr19-11173626" "chr19-11173716" "chr19-11173807" ...</span></span>
<span><span class="co">#&gt;  $ varbeta: Named num [1:1000] 0.000516 0.000399 0.003124 0.000419 0.000473 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:1000] "chr19-11173352" "chr19-11173626" "chr19-11173716" "chr19-11173807" ...</span></span>
<span><span class="co">#&gt;  $ z      : Named num [1:1000] -0.603 0.834 1.62 -0.279 -2.578 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:1000] "chr19-11173352" "chr19-11173626" "chr19-11173716" "chr19-11173807" ...</span></span>
<span><span class="co">#&gt;  $ snp    : chr [1:1000] "chr19-11173352" "chr19-11173626" "chr19-11173716" "chr19-11173807" ...</span></span>
<span><span class="co">#&gt;  $ MAF    : Named num [1:1000] 0.2614 0.4871 0.0318 0.4046 0.3042 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:1000] "chr19-11173352" "chr19-11173626" "chr19-11173716" "chr19-11173807" ...</span></span>
<span><span class="co">#&gt;  $ type   : chr "cc"</span></span>
<span><span class="co">#&gt;  $ N      : num 20000</span></span>
<span><span class="co">#&gt;  $ s      : num 0.5</span></span>
<span><span class="va">querysnpid</span> <span class="op">&lt;-</span> <span class="va">cophe_multi_trait_data</span><span class="op">$</span><span class="va">querysnpid</span></span></code></pre></div>
<div class="section level4">
<h4 id="multi-trait-analysis">Multi-trait analysis<a class="anchor" aria-label="anchor" href="#multi-trait-analysis"></a>
</h4>
<p>The first step is preparing the input for the hierarchical model
which are the log Bayes factors: lBF.Ha and lBF.Hc. We will use
<code>cophe.susie.lbf</code> to extract Bayes factors estimated using
SuSIE. Note: When there are no credible sets identified with SuSIE the
function internally calculates lBF.Ha and lBF.Hc using the Approximate
Bayes Factor method.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Hide print messages from coloc</span></span>
<span><span class="va">res.multi.lbf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">trait_idx</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">cophe_multi_trait_data</span><span class="op">$</span><span class="va">summ_stat</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">querytrait_ss</span> <span class="op">&lt;-</span> <span class="va">cophe_multi_trait_data</span><span class="op">$</span><span class="va">summ_stat</span><span class="op">[[</span><span class="va">trait_idx</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="co"># Here LD is the same</span></span>
<span>  <span class="va">querytrait_ss</span><span class="op">$</span><span class="va">LD</span> <span class="op">&lt;-</span> <span class="va">LD</span></span>
<span>  <span class="va">trait_variant_pair</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Trait'</span>, <span class="va">trait_idx</span>, <span class="st">'_'</span>, <span class="va">querysnpid</span><span class="op">)</span></span>
<span>  <span class="va">res.multi.lbf</span><span class="op">[[</span><span class="va">trait_variant_pair</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cophe.susie.lbf.html">cophe.susie.lbf</a></span><span class="op">(</span><span class="va">querytrait_ss</span>, querysnpid <span class="op">=</span> <span class="va">querysnpid</span>, querytrait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Trait'</span>, <span class="va">trait_idx</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">res.multi.lbf.df</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">res.multi.lbf</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res.multi.lbf.df</span><span class="op">)</span></span>
<span><span class="co">#&gt;      lBF.Ha   lBF.Hc nsnps       querysnp querytrait           hit1</span></span>
<span><span class="co">#&gt; 1: 15.31003 11.95277  1000 chr19-11182353     Trait1 chr19-11182353</span></span>
<span><span class="co">#&gt; 2: 16.43401 13.00673  1000 chr19-11182353     Trait2 chr19-11182353</span></span>
<span><span class="co">#&gt; 3: 17.36744 13.13794  1000 chr19-11182353     Trait3 chr19-11182353</span></span>
<span><span class="co">#&gt; 4: 14.45423 10.44441  1000 chr19-11182353     Trait4 chr19-11182353</span></span>
<span><span class="co">#&gt; 5: 15.82635 12.54912  1000 chr19-11182353     Trait5 chr19-11182353</span></span>
<span><span class="co">#&gt; 6: 16.23052 12.88257  1000 chr19-11182353     Trait6 chr19-11182353</span></span>
<span><span class="co">#&gt;              hit2  typeBF idx1 idx2</span></span>
<span><span class="co">#&gt; 1: chr19-11182144 susieBF    1    1</span></span>
<span><span class="co">#&gt; 2: chr19-11183133 susieBF    1    1</span></span>
<span><span class="co">#&gt; 3: chr19-11189906 susieBF    1    1</span></span>
<span><span class="co">#&gt; 4: chr19-11182538 susieBF    1    1</span></span>
<span><span class="co">#&gt; 5: chr19-11176397 susieBF    1    1</span></span>
<span><span class="co">#&gt; 6: chr19-11182135 susieBF    1    1</span></span></code></pre></div>
<p><strong>Note: </strong> The output of <code>cophe.susie</code> or
<code>cophe.single</code> can also be used as input to the hierarchical
model as it has all the fields required for the input. This would be
useful when you would like to compare results from the fixed priors to
those obtained from priors inferred using the hierarchical model. [Swap
<code>cophe.susie</code> for <code>cophe.susie.lbf</code> above and
instead of bind_rows do :
<code>res.multi.lbf.df = multitrait.simplify(res.multi.lbf)</code>]</p>
</div>
<div class="section level4">
<h4 id="run-hierarchical-model-for-priors">Run hierarchical model for priors<a class="anchor" aria-label="anchor" href="#run-hierarchical-model-for-priors"></a>
</h4>
<p>The input df for the multi.dat arguments should contain the following
fields: “lBF.Ha”,“lBF.Hc” and “nsnps”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># covar=F</span></span>
<span><span class="co">## Set covar to TRUE to include covariates</span></span>
<span><span class="va">covar</span><span class="op">=</span><span class="cn">T</span></span>
<span><span class="va">covar_vec</span> <span class="op">=</span> <span class="va">cophe_multi_trait_data</span><span class="op">$</span><span class="va">covar_vec</span></span>
<span><span class="va">cophe.hier.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_metrop_priors.html">run_metrop_priors</a></span><span class="op">(</span><span class="va">res.multi.lbf.df</span>, avg_posterior<span class="op">=</span><span class="cn">T</span>, avg_pik <span class="op">=</span> <span class="cn">T</span>, covar_vec <span class="op">=</span> <span class="va">covar_vec</span>, covar <span class="op">=</span> <span class="va">covar</span>, nits <span class="op">=</span> <span class="fl">30000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running the cophescan hierarchical model... </span></span>
<span><span class="co">#&gt; Number of iterations: 30000</span></span>
<span><span class="co">#&gt; Burn-in: 1</span></span>
<span><span class="co">#&gt; Number of input QV/QT pairs: 24</span></span>
<span><span class="co">#&gt; Covariate included: TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cophe.hier.res</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ll"            "parameters"    "avg.posterior" "avg.pik"      </span></span>
<span><span class="co">#&gt; [5] "data"          "nits"          "thin"          "covar_vec"</span></span></code></pre></div>
<p>Note: Setting posterior or pik to TRUE is memory intensive for very
large datasets</p>
</div>
<div class="section level4">
<h4 id="diagnostics-of-the-hierarchical-model">Diagnostics of the hierarchical model<a class="anchor" aria-label="anchor" href="#diagnostics-of-the-hierarchical-model"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loglik</span> <span class="op">&lt;-</span> <span class="va">cophe.hier.res</span><span class="op">$</span><span class="va">ll</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="va">cophe.hier.res</span><span class="op">$</span><span class="va">parameters</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span>red <span class="op">=</span> <span class="fl">0.4</span>, green <span class="op">=</span> <span class="fl">0.7</span>, blue <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">loglik</span><span class="op">)</span>, <span class="va">loglik</span>, main<span class="op">=</span><span class="st">"loglik"</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="va">col</span>, ylab <span class="op">=</span> <span class="st">"ll"</span>, xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span>, <span class="va">parameters</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, main<span class="op">=</span><span class="st">"alpha"</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="va">col</span>, ylab <span class="op">=</span> <span class="st">"alpha"</span>, xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span>, <span class="va">parameters</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, main<span class="op">=</span><span class="st">"beta"</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="va">col</span>, ylab <span class="op">=</span> <span class="st">"beta"</span>, xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">covar</span> <span class="op">==</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span>, <span class="va">parameters</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span>, main<span class="op">=</span><span class="st">"gamma"</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="va">col</span>, ylab <span class="op">=</span> <span class="st">"gamma"</span>, xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="HP-mcmcDiagnostics-1.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="prediction">Prediction<a class="anchor" aria-label="anchor" href="#prediction"></a>
</h4>
<p><code>cophe.hier.res$avg.posterior</code> contains the posterior
probabilities of the hypotheses : <span class="math inline">\(H_n\)</span>, <span class="math inline">\(H_a\)</span> and <span class="math inline">\(H_c\)</span> for the queryvariant/querytraut pairs
obtained from the hierarchical model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.post.prob</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cophe.hier.res</span><span class="op">$</span><span class="va">avg.posterior</span>, <span class="va">cophe.hier.res</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.hier.predict</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cophe.hyp.predict.html">cophe.hyp.predict</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">res.post.prob</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hc.cutoff = 0.6"</span></span>
<span><span class="co">#&gt; [1] "Hn.cutoff = 0.2"</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">res.post.prob</span>, row.names <span class="op">=</span> <span class="cn">F</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="3%">
<col width="3%">
<col width="3%">
<col width="4%">
<col width="4%">
<col width="3%">
<col width="9%">
<col width="7%">
<col width="9%">
<col width="9%">
<col width="5%">
<col width="3%">
<col width="3%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th align="right">PP.Hn</th>
<th align="right">PP.Ha</th>
<th align="right">PP.Hc</th>
<th align="right">lBF.Ha</th>
<th align="right">lBF.Hc</th>
<th align="right">nsnps</th>
<th align="left">querysnp</th>
<th align="left">querytrait</th>
<th align="left">hit1</th>
<th align="left">hit2</th>
<th align="left">typeBF</th>
<th align="right">idx1</th>
<th align="right">idx2</th>
<th align="left">sus_labels</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.009</td>
<td align="right">0.991</td>
<td align="right">15.310</td>
<td align="right">11.953</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait1</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11182144</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait1_chr19-11182353_hit_chr19-11182144</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">0.002</td>
<td align="right">0.998</td>
<td align="right">16.434</td>
<td align="right">13.007</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait2</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11183133</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait2_chr19-11182353_hit_chr19-11183133</td>
</tr>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.006</td>
<td align="right">0.994</td>
<td align="right">17.367</td>
<td align="right">13.138</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait3</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11189906</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait3_chr19-11182353_hit_chr19-11189906</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">0.126</td>
<td align="right">0.874</td>
<td align="right">14.454</td>
<td align="right">10.444</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait4</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11182538</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait4_chr19-11182353_hit_chr19-11182538</td>
</tr>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.004</td>
<td align="right">0.996</td>
<td align="right">15.826</td>
<td align="right">12.549</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait5</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11176397</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait5_chr19-11182353_hit_chr19-11176397</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">0.003</td>
<td align="right">0.997</td>
<td align="right">16.231</td>
<td align="right">12.883</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait6</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11182135</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait6_chr19-11182353_hit_chr19-11182135</td>
</tr>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.006</td>
<td align="right">0.994</td>
<td align="right">31.880</td>
<td align="right">28.847</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait7</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11180916</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait7_chr19-11182353_hit_chr19-11180916</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">0.007</td>
<td align="right">0.993</td>
<td align="right">17.096</td>
<td align="right">13.571</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait8</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11180916</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait8_chr19-11182353_hit_chr19-11180916</td>
</tr>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">0.999</td>
<td align="right">0.000</td>
<td align="right">16.432</td>
<td align="right">-1.258</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait9</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11248290</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait9_chr19-11182353_hit_chr19-11248290</td>
</tr>
<tr class="even">
<td align="right">0.001</td>
<td align="right">0.999</td>
<td align="right">0.000</td>
<td align="right">15.470</td>
<td align="right">-1.667</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait10</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11267263</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait10_chr19-11182353_hit_chr19-11267263</td>
</tr>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
<td align="right">22.573</td>
<td align="right">-1.562</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait11</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11254605</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait11_chr19-11182353_hit_chr19-11254605</td>
</tr>
<tr class="even">
<td align="right">0.002</td>
<td align="right">0.998</td>
<td align="right">0.000</td>
<td align="right">14.952</td>
<td align="right">-1.332</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait12</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11256677</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait12_chr19-11182353_hit_chr19-11256677</td>
</tr>
<tr class="odd">
<td align="right">0.001</td>
<td align="right">0.999</td>
<td align="right">0.000</td>
<td align="right">15.774</td>
<td align="right">-1.222</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait13</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11267299</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait13_chr19-11182353_hit_chr19-11267299</td>
</tr>
<tr class="even">
<td align="right">0.001</td>
<td align="right">0.999</td>
<td align="right">0.000</td>
<td align="right">16.132</td>
<td align="right">0.163</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait14</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11269041</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait14_chr19-11182353_hit_chr19-11269041</td>
</tr>
<tr class="odd">
<td align="right">0.000</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
<td align="right">18.868</td>
<td align="right">-1.383</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait15</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11256677</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait15_chr19-11182353_hit_chr19-11256677</td>
</tr>
<tr class="even">
<td align="right">0.000</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
<td align="right">17.282</td>
<td align="right">-1.718</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait16</td>
<td align="left">chr19-11182353</td>
<td align="left">chr19-11271299</td>
<td align="left">susieBF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Trait16_chr19-11182353_hit_chr19-11271299</td>
</tr>
<tr class="odd">
<td align="right">0.871</td>
<td align="right">0.110</td>
<td align="right">0.019</td>
<td align="right">6.318</td>
<td align="right">-1.510</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait17</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">ABF</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Trait17_NA_hit_NA</td>
</tr>
<tr class="even">
<td align="right">0.656</td>
<td align="right">0.060</td>
<td align="right">0.284</td>
<td align="right">5.982</td>
<td align="right">-1.462</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait18</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">ABF</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Trait18_NA_hit_NA</td>
</tr>
<tr class="odd">
<td align="right">0.862</td>
<td align="right">0.089</td>
<td align="right">0.049</td>
<td align="right">6.110</td>
<td align="right">-1.618</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait19</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">ABF</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Trait19_NA_hit_NA</td>
</tr>
<tr class="even">
<td align="right">0.903</td>
<td align="right">0.081</td>
<td align="right">0.016</td>
<td align="right">5.965</td>
<td align="right">-1.559</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait20</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">ABF</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Trait20_NA_hit_NA</td>
</tr>
<tr class="odd">
<td align="right">0.890</td>
<td align="right">0.073</td>
<td align="right">0.036</td>
<td align="right">5.879</td>
<td align="right">-0.707</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait21</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">ABF</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Trait21_NA_hit_NA</td>
</tr>
<tr class="even">
<td align="right">0.832</td>
<td align="right">0.096</td>
<td align="right">0.072</td>
<td align="right">6.226</td>
<td align="right">-0.584</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait22</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">ABF</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Trait22_NA_hit_NA</td>
</tr>
<tr class="odd">
<td align="right">0.856</td>
<td align="right">0.087</td>
<td align="right">0.057</td>
<td align="right">6.091</td>
<td align="right">-1.522</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait23</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">ABF</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Trait23_NA_hit_NA</td>
</tr>
<tr class="even">
<td align="right">0.877</td>
<td align="right">0.080</td>
<td align="right">0.044</td>
<td align="right">5.978</td>
<td align="right">-1.627</td>
<td align="right">1000</td>
<td align="left">chr19-11182353</td>
<td align="left">Trait24</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">ABF</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Trait24_NA_hit_NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="visualisation">Visualisation<a class="anchor" aria-label="anchor" href="#visualisation"></a>
</h4>
<p>Use the <code>cophe_plot</code> function to return -log10(pval), ppHa
and ppHc PheWAS plots from the cophescan output</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plots</span> <span class="op">=</span> <span class="fu"><a href="../reference/cophe_plot.html">cophe_plot</a></span><span class="op">(</span><span class="va">res.hier.predict</span>, traits.dat <span class="op">=</span> <span class="va">cophe_multi_trait_data</span><span class="op">$</span><span class="va">summ_stat</span>, querysnpid <span class="op">=</span> <span class="va">querysnpid</span>, pheno_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Trait'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="st">"ggpubr"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">res.plots</span><span class="op">$</span><span class="va">pval</span>, <span class="va">res.plots</span><span class="op">$</span><span class="va">ppHa</span>, <span class="va">res.plots</span><span class="op">$</span><span class="va">ppHc</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span> </span></code></pre></div>
<p><img src="HP-cophePlots-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ichcha Manipur, Chris Wallace.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
